(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{8846:function(e,t,a){Promise.resolve().then(a.bind(a,3522))},3801:function(e,t,a){"use strict";a.r(t),a.d(t,{CartContext:function(){return l},CartProvider:function(){return i},useCart:function(){return r}});var s=a(7437),n=a(2265);let l=(0,n.createContext)({cartItems:[],addToCart:e=>{},removeFromCart:e=>{},clearCart:()=>{}}),r=()=>(0,n.useContext)(l),i=e=>{let{children:t}=e,[a,r]=(0,n.useState)([]);return(0,s.jsx)(l.Provider,{value:{cartItems:a,addToCart:e=>{r(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?{...t,quantityInCart:t.quantityInCart+1}:t):[...t,{...e,quantityInCart:1}])},removeFromCart:e=>{r(t=>{let a=t.findIndex(t=>t.id===e);return a>-1&&t[a].quantityInCart>1?t.map((e,t)=>t===a?{...e,quantityInCart:e.quantityInCart-1}:e):t.filter(t=>t.id!==e)})},clearCart:()=>{r([])}},children:t})}},3522:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var s=a(7437),n=a(2265),l=a(3801),r=a(6691),i=a.n(r),o=a(4578),c=a(173);function d(){let{cartItems:e,clearCart:t}=(0,l.useCart)(),[a,r]=(0,n.useState)({name:"",phone:"",email:"",city:"",note:""}),[d,m]=(0,n.useState)({}),[u,x]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),b=e.reduce((e,t)=>e+t.price*t.quantityInCart,0),f=new RegExp(/^([+]?[\s0-9]+)?(\d{3}|[(]?[0-9]+[)])?([-]?[\s]?[0-9])+$/),y=o.z.object({name:o.z.string().nonempty({message:"Name is required."}),phone:o.z.string().regex(f,{message:"Invalid phone number.   "}),email:o.z.string().email({message:"Invalid email address."}).nonempty({message:"Email address is required."}),city:o.z.string().nonempty({message:"City is required."}),note:o.z.string().optional()}),g=e=>{let{id:t,value:s}=e.target;r({...a,[t]:s})},j=async s=>{s.preventDefault();try{y.parse(a);let s=e.map(e=>({product:e.name,quantity:e.quantityInCart}));(await fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json",cache:"no-cache"},body:JSON.stringify({items:s,name:a.name,phone:a.phone,email:a.email,city:a.city,note:a.note})})).ok?(x(!0),t()):x(!1),p(!1)}catch(e){if(e instanceof o.z.ZodError){let t={};for(let a of e.issues)t[a.path[0]]=a.message;m(t)}}};return u?(0,s.jsx)("div",{className:"container mx-auto p-6 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(c.Z,{className:"h-12 w-12 text-green-500"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-center mt-4",children:"Order Received"}),(0,s.jsx)("p",{className:"text-center mt-2",children:"We'll be reaching out shortly."})]})}):(0,s.jsx)("div",{className:"container mx-auto p-6",children:(0,s.jsxs)("div",{className:"flex flex-wrap -mx-4",children:[(0,s.jsx)("div",{className:"w-full lg:w-2/3 px-4",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded shadow-sm",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-5",children:"Billing Details"}),(0,s.jsxs)("form",{onSubmit:j,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"Name"}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"name",type:"text",placeholder:"Your Name",value:a.name,onChange:g}),d.name&&(0,s.jsx)("p",{className:"text-red-500 text-xs italic",children:d.name})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"phone",children:"Phone Number"}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"phone",type:"tel",placeholder:"Phone Number",value:a.phone,onChange:g}),d.phone&&(0,s.jsx)("p",{className:"text-red-500 text-xs italic",children:d.phone})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email Address"}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email",type:"email",placeholder:"Email Address",value:a.email,onChange:g}),d.email&&(0,s.jsx)("p",{className:"text-red-500 text-xs italic",children:d.email})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"city",children:"City"}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"city",type:"text",placeholder:"City",value:a.city,onChange:g}),d.city&&(0,s.jsx)("p",{className:"text-red-500 text-xs italic",children:d.city})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"note",children:"Note (Optional)"}),(0,s.jsx)("textarea",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"note",placeholder:"Any special instructions or message?",rows:4,value:a.note,onChange:g})]}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)("button",{type:"submit",className:"w-full font-bold py-3 px-4 rounded ".concat(h?"bg-gray-500 cursor-not-allowed":"bg-sky-500 hover:bg-sky-600"," text-white"),disabled:h,children:h?"Submitting Order...":"Place Order"})})]})]})}),(0,s.jsx)("div",{className:"w-full lg:w-1/3 px-4",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded shadow-sm",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-5",children:"Your Order"}),e.map(e=>(0,s.jsx)("div",{className:"mb-4 flex justify-between items-center",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(i(),{src:"https://cms.alohakush.ca".concat(e.thumbnailImageUrl),alt:e.name,width:64,height:64,className:"h-16 w-16 mr-4 object-cover rounded"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:e.name}),(0,s.jsxs)("p",{children:["Qty: ",e.quantityInCart]}),(0,s.jsxs)("p",{children:["Price: $",e.price]})]})]})},e.id)),(0,s.jsx)("div",{className:"border-t border-gray-300 mt-4 pt-4",children:(0,s.jsxs)("p",{className:"text-lg font-bold",children:["Total: $",b.toFixed(2)]})})]})})]})})}}},function(e){e.O(0,[749,961,971,938,744],function(){return e(e.s=8846)}),_N_E=e.O()}]);